# LLM 요약 프롬프트 개선 아이디어

현재 `lib/llm/summarize.ts`의 `MD_SYSTEM_PROMPT` / `MD_USER_PROMPT_PREFIX`를 업그레이드하기 위한 제안 목록입니다.  
**바로 적용하지 말고**, 여러 AI 추천과 비교 후 선택해서 반영하세요.

---

## 1. 역할·목적 구체화

- **현재**: "You are a helpful assistant that summarizes study notes in Korean."
- **개선**: 역할과 **사용 목적**을 한 문장으로 명시하면 형식 준수율이 올라갑니다.
  - 예: "당신은 수업·강의·교재 내용을 요약하는 전문 어시스턴트입니다. 학습자가 나중에 복습할 때 **핵심만 빠르게 떠올릴 수 있도록** 정리합니다."

---

## 2. 출력 구조 명확화

- **맨 앞 개요**: 원문이 길 때, 요약 최상단에 "이 자료의 핵심을 1~2문장으로" 같은 **한 줄 요약**을 넣을지 여부를 프롬프트에 명시.
- **목차 활용**: 큰 섹션(## 1., ## 2. …)만 나열한 짧은 목차를 첫 블록에 넣을지 선택 가능하게 하면, 스캔이 쉬워짐.

---

## 3. 원문 순서 vs 재구성

- **현재**: 원문 "끝까지" 포함은 있지만, **순서 유지**인지 **주제별 재구성**인지 없음.
- **개선**: 다음 중 하나를 명시.
  - "원문의 **흐름(등장 순서)을 유지**한 채 요약하세요."
  - 또는 "비슷한 주제는 묶어서 재구성해도 됩니다. 다만 원문에 있던 내용만 포함하세요."

---

## 4. 길이·깊이 가이드

- **현재**: "요약이 길어져도 괜찮으니 끝까지 다 쓰세요"만 있음.
- **개선**: 상대적 가이드 추가로 일관성 확보.
  - 예: "원문의 **20~40% 분량**을 목표로 하되, 중요한 부분은 더 자세히, 부가 설명은 한두 문장으로."
  - 또는 "핵심 주제는 2~3문장, 보조 설명은 1문장 이내로."

---

## 5. 용어·표기 일관성

- **전문 용어**: 원문 표기 그대로 사용, **첫 등장 시** 굵게(**용어**) 또는 괄호 설명 권장.
- **약어**: 첫 등장 시 풀어쓰기 예시 명시.  
  예: "API → 'Application Programming Interface (API)'처럼 첫 등장 시 풀어쓰기."

---

## 6. 목록/리스트 규칙

- 나열이 **3개 이상**이면 `- ` 리스트 사용.
- **순서가 있는 단계**는 `1. 2. 3.` 형태 권장.
- 한 항목이 한 문장을 넘어가면 다음 줄에 들여쓰기 등 규칙 한 줄 추가 가능.

---

## 7. 금지 사항 한곳에 모으기

- **현재**: 코드 블록 금지, 원문에 없는 사실 금지, 중간 끊기 금지, 반복 금지가 여러 곳에 흩어져 있음.
- **개선**: "## 금지 사항" 하나로 묶어서 나열.
  - 세 개의 백틱(```) 코드 블록 사용 금지
  - 원문에 없는 사실·추측 추가 금지
  - 출력을 원문 끝까지 다루기 전에 끊지 말 것
  - 같은 내용 불필요하게 반복 금지  
  → 모델이 "하지 말 것"을 한 번에 인식하기 쉬움.

---

## 8. Few-shot 예시 (선택)

- **형식 예시**를 1~2개 짧게 넣으면 "## 1. 소제목", "---", "### 소제목" 사용이 안정됨.
- 단점: 토큰 사용량 증가. **요약 품질이 형식보다 중요하면** 생략해도 됨.

---

## 9. 말투(톤) 통일

- "수업/자료 요약"이므로 문장 끝 표현을 통일하라고 명시.
  - 예: "문장은 **합니다체(해요체)** 로 통일하세요. 반말이나 구어체는 사용하지 마세요."

---

## 10. 수평선(---) 사용 세분화

- **현재**: "## 1., ## 2. … 사이에 --- 넣어 구분."
- **개선**: `###` 소제목 아래에는 넣지 않는다 / 넣는다 중 하나를 명시하면 레이아웃이 더 일관됨.  
  예: "수평선(---)은 **큰 섹션(## 1., ## 2. …) 사이에만** 넣고, ### 소제목 아래에는 넣지 마세요."

---

## 11. 인라인 코드 vs 일반 텍스트

- **현재**: 세 개 백틱 블록 금지, 인라인 코드(`한 개`)는 허용.
- **개선**: "코드·명령어·키워드·함수명은 **반드시 인라인 코드(`...`)로** 표기하고, 설명 문장은 일반 텍스트로 작성하세요."처럼 역할을 명시.

---

## 12. 빈 줄/단락 규칙

- 섹션과 섹션 사이: 빈 줄 1줄.
- 큰 구분(---) 전후: 빈 줄 1줄 등, 최소한의 규칙을 한 줄로 넣으면 파싱·가독성에 도움.

---

## 13. 실패 방지·검증 유도

- **단계 지시**: "요약을 쓰기 **전에** 원문을 끝까지 한 번 읽고, 마지막 문장·단락이 무엇인지 확인한 뒤 진행하세요."
- **끝맺음 검증**: "요약의 **마지막 문장/단락**이 원문의 **마지막 주제**를 반영해야 합니다."  
  → 중간에 끊기는 현상을 줄이기 좋음.

---

## 14. 다국어·숫자·공식

- 원문에 영어·수식·코드 조각이 많을 수 있음.
- **개선**: "설명은 **한국어**로 하되, **전문 용어·고유명사·수식·코드 조각**은 원문 그대로 유지하세요."

---

## 15. 지시 우선순위 명시

- 지시가 많을 때 충돌 방지.
- **개선**: 한 줄 추가.  
  예: "**내용의 완전성(원문 끝까지 포함)**이 **형식(헤딩·리스트 스타일)**보다 우선입니다. 형식을 맞추다가 내용을 생략하지 마세요."

---

## 요약 표 (우선 적용 추천)

| 번호 | 항목               | 기대 효과                     | 적용 난이도 |
|------|--------------------|--------------------------------|------------|
| 7    | 금지 사항 한곳에   | 규칙 인식 명확, 위반 감소     | 쉬움       |
| 13   | 실패 방지·검증     | 중간 끊김·누락 감소           | 쉬움       |
| 15   | 우선순위 명시      | 형식 vs 내용 충돌 시 행동 고정 | 쉬움       |
| 1    | 역할·목적 구체화   | 톤·구조 일관성                | 쉬움       |
| 9    | 말투 통일         | 문체 일관성                   | 쉬움       |
| 4    | 길이·깊이 가이드  | 요약 분량·상세도 조절         | 중간       |
| 3    | 원문 순서 vs 재구성| 구조 의도 명확                 | 중간       |
| 14   | 다국어·숫자·공식  | 원문 충실도                   | 중간       |

나머지(2, 5, 6, 8, 10, 11, 12)는 필요에 따라 선택 적용하면 됩니다.

---

*이 문서는 프롬프트 개선 시 참고용입니다. 실제 수정은 `lib/llm/summarize.ts`에서 반영하세요.*
